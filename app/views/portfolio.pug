extends base_layout

block scripts 

block content

  if holdings.length > 0
    div(class="container")
      h2= `Total value: ${totalPortfolioValue}`
      br
      div(class="table-responsive")
        table(class="table table-bordered table-hover")
          thead 
            tr
              th(scope="col") Company Name
              th(scope="col") Symbol
              th(scope="col") Current Price 
              th(scope="col") Quantity 
              th(scope="col") Average Price
              th(scope="col") Total
              th(scope="col") Daily Change
              th(scope="col") YTD Change 
              th(scope="col") Current Value
              th(scope="col") Yield
          tbody 
            - var currentTotal = 0
            each row in holdings
              - currentTotal += row.quote.latestPrice * row.portfolio.quantity
              tr(id=`${row.quote.symbol}`)
                td= row.quote.companyName
                td= row.quote.symbol
                td= Number.parseFloat(row.quote.latestPrice).toFixed(2)
                td= row.portfolio.quantity
                td= Number.parseFloat(row.portfolio.total / row.portfolio.quantity).toFixed(2)
                td= Number.parseFloat(row.portfolio.total).toFixed(2)
                td(class=row.quote.changePercent >= 0 ? "text-success" : "text-danger")= `${Number.parseFloat(row.quote.changePercent).toFixed(2)}%`
                td(class=row.quote.ytdChange >= 0 ? "text-success" : "text-danger")= `${Number.parseFloat(row.quote.ytdChange).toFixed(2)}%`
                td= Number.parseFloat(row.portfolio.quantity * row.quote.latestPrice).toFixed(2)
                - var stockYield = row.quote.latestPrice / (row.portfolio.total / row.portfolio.quantity) - 1
                td(class=stockYield >= 0 ? "text-success" : "text-danger")= `${Number.parseFloat(stockYield * 100).toFixed(2)}%`
  else 
    p bye
    